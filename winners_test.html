<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Rage Space ‚Äî Winners</title>
  <style>
    :root { --green:#39ff14; --border:#0f2510; --ink:#e5ffe5; --bg:#000; }
    html,body{ height:100%; margin:0; background:var(--bg); color:var(--green); font-family: ui-sans-serif,system-ui,Arial,Helvetica,sans-serif; }
    .wrap{ max-width:980px; margin:16px auto 64px; padding:0 16px; }
    header{ display:flex; align-items:center; justify-content:space-between; gap:12px; border:1px solid var(--border);
      padding:10px 12px; border-radius:12px; background:rgba(7,7,7,.6); }
    .btn{
      border:1px solid var(--green); color:var(--green); text-decoration:none; padding:8px 12px;
      border-radius:10px; display:inline-flex; align-items:center; gap:8px; background:transparent; cursor:pointer;
    }
    .grid{ margin-top:16px; display:grid; grid-template-columns:1fr; gap:12px; }
    .card{ border:1px solid var(--border); border-radius:14px; overflow:hidden; background:rgba(7,7,7,.6); }
    .hero{ aspect-ratio: 16/9; width:100%; display:block; }
    .hero.red{ background: repeating-linear-gradient(45deg, #3a0000 0, #3a0000 12px, #5a0000 12px, #5a0000 24px), #a60000; }
    .hero.blue{ background: repeating-linear-gradient(45deg, #001c3a 0, #001c3a 12px, #00325a 12px, #00325a 24px), #0058a6; }
    .meta{ padding:10px 12px; display:flex; align-items:center; justify-content:space-between; gap:12px; }
    .muted{ color:var(--ink); opacity:.8; font-size:.95rem; }
    .empty{ opacity:.7; padding:16px; border:1px dashed var(--border); border-radius:12px; text-align:center; }
    .list{ border:1px solid var(--border); border-radius:12px; overflow:hidden; }
    .row{ display:grid; grid-template-columns: 120px 1fr 1fr; gap:10px; padding:10px; border-top:1px solid #0b1c0b; align-items:center; }
    .row:first-child{ border-top:none; background:rgba(7,7,7,.4); font-weight:700 }
    .chip{ border:1px solid var(--border); border-radius:999px; padding:4px 10px; }
    a{ color:#9ae6b4; text-decoration:none; }
    a:hover{ text-decoration:underline; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1 style="margin:0">üèÅ Winners</h1>
        <div class="muted">Shows the winner decided at each 10s rollover (local demo)</div>
      </div>
      <div style="display:flex; gap:8px; flex-wrap:wrap;">
        <a class="btn" href="matchup.html">‚Üê Back to Matchup</a>
        <button id="btnClear" class="btn">üßπ Clear</button>
      </div>
    </header>

    <div id="content" class="grid"></div>
  </div>

  <script>
    const winnersKey = 'rs_winners_v1';
    function readWinners(){
      try{ return JSON.parse(localStorage.getItem(winnersKey) || '[]') }catch{ return [] }
    }
    function clearWinners(){
      if (confirm('Clear local winners history?')) {
        localStorage.removeItem(winnersKey);
        render();
      }
    }

    function winnerCard(w){
      const card = document.createElement('div');
      card.className = 'card';
      const hero = document.createElement('div');
      hero.className = 'hero ' + (w.color==='red' ? 'red' : 'blue');
      const meta = document.createElement('div');
      meta.className = 'meta';
      const left = document.createElement('div');
      const right= document.createElement('div');
      right.innerHTML = `<span class="chip">#${w.id}</span>`;
      left.innerHTML = `<div class="muted"><b>${w.name}</b> won</div><div class="muted">${new Date(w.ts).toLocaleString()}</div>`;
      meta.append(left, right);
      card.append(hero, meta);
      return card;
    }

    function listTable(rows){
      const box = document.createElement('div');
      box.className = 'list';
      const head = document.createElement('div');
      head.className = 'row';
      head.innerHTML = `<div>When</div><div>Winner</div><div>Color</div>`;
      box.append(head);
      rows.forEach(r=>{
        const row = document.createElement('div');
        row.className = 'row';
        row.innerHTML = `
          <div>${new Date(r.ts).toLocaleTimeString()}</div>
          <div>${r.name}</div>
          <div><span class="chip">${r.color.toUpperCase()}</span></div>`;
        box.append(row);
      });
      return box;
    }

    function render(){
      const root = document.getElementById('content');
      root.innerHTML = '';

      const winners = readWinners();
      if (!winners.length){
        const empty = document.createElement('div');
        empty.className = 'empty';
        empty.textContent = 'No winners yet. Open matchup and let it run.';
        root.append(empty);
        return;
      }

      // Big last winner
      root.append(winnerCard(winners[0]));

      // History table under it
      root.append(listTable(winners.slice(0, 20)));
    }

    document.getElementById('btnClear').addEventListener('click', clearWinners);
    render();
  </script>
</body>
</html>